//: [Previous](@previous)

import Foundation

//新量表获取
func newPePbScore(industry:String) -> (peScore: Double, pbScore:Double) {
    switch industry {
    case "煤炭":
        return  (5,   0.5)
    case "电力":
        return  (8,   0.8)
    case "石油":
        return  (6,   0.6)
    case "钢铁-普银":
        return   (4,   0.4)
    case "钢铁":
        return   (5,   0.5)
    case "钢铁-钢力":
        return   (7,   0.6)
    case "有色":
        return  (8,   0.8)
    case "化纤":
        return  (8,   0.8)
    case "化工":
        return  (7,   0.7)
    case "建材":
        return  (5,   0.5)
    case "造纸":
        return  (8,   0.6)
    case "矿物制品":
        return    (10,  1)
    case "日用化工":
        return    (10,  1)
    case "农林牧渔":
        return    (10,  1)
    case "纺织服饰":
        return    (8,   0.8)
    case "服饰":
        return  (6,   0.7)
    case "食品饮料":
        return    (10,  1)
    case "酿酒":
        return  (10,  1)
    case "家用电器":
        return    (6,   0.6)
    case "汽车类":
        return (8,   0.8)
    case "医疗保健":
        return    (10,  1)
    case "家居用品":
        return    (8,   0.9)
    case "医药":
        return  (10,  1)
    case "商业连锁":
        return    (8,   0.8)
    case "商贸代理":
        return    (7,   0.7)
    case "传媒娱乐":
        return    (7,   0.7)
    case "广告包装":
        return    (10,  1)
    case "文教休闲":
        return    (10,  1)
    case "酒店餐饮":
        return    (10,  1)
    case "旅游":
        return  (10,  1)
    case "航空":
        return  (10,  1)
    case "船舶":
        return  (10,  1)
    case "运输设备":
        return    (9,   0.7)
    case "通用机械":
        return    (10,  1)
    case "工业机械":
        return    (9,   0.8)
    case "电气设备":
        return    (10,  1)
    case "工程机械":
        return    (8,   0.8)
    case "电器仪表":
        return    (8,   0.8)
    case "电信运营":
        return    (10,  1)
    case "公共交通":
        return    (8,   0.8)
    case "水务":
        return  (8,   0.7)
    case "供气供热":
        return    (10,  1)
    case "环境保护":
        return    (10,  0.8)
    case "运输服务":
        return    (7,   0.7)
    case "仓储物流":
        return    (6,   0.5)
    case "交通设施":
        return    (6,   0.6)
    case "银行":
        return  (4,   0.4)
    case "证券":
        return  (10,  0.9)
    case "保险":
        return  (8,   0.8)
    case "多元金融":
        return    (5,   0.5)
    case "建筑":
        return  (4,   0.4)
    case "房地产":
        return (5,   0.5)
    case "IT设备":
        return    (10,  1)
    case "通信设备":
        return    (10,  1)
    case "半导体":
        return (10,  1)
    case "元器件":
        return (10,  1)
    case "软件服务":
        return    (10,  1)
    case "互联网":
        return (10,  1)
    case "综合类":
        return (10,  1)
    default:
        return (10, 1)
    }
}

//行业数据
struct IndustryModel {
    var name:String
    var stocks:[stockModel]
    var totalPrice:Double{
        if self.stocks.isEmpty {
            return 0
        }else{
            var price:Double = 0
            for model in stocks {
                price = price + model.price
            }
            return price
        }
    }
}

//Model 计算属性
struct stockModel {
    var name:String
    var code:Int
    var price:Double
    var industry: String {
        getIndustry(code: code)
    }
    
    func getIndustry(code:Int) -> String {
        switch code {
        case 552,571,723,937,983,600121,600123,600188,600348,600395,600397,600403,600408,600508,600546,600740,600758,600792,600925,600971,600985,600997,601001,601011,601015,601088,601101,601225,601666,601699,601898,601918,603113:
            return    "煤炭"
        case 27,37,40,155,531,537,539,543,591,600,601,690,767,791,862,875,883,899,966,993,1258,1286,1289,1896,2015,2039,2256,2608,3035,3816,301046,600011,600021,600023,600025,600027,600032,600098,600101,600116,600157,600163,600236,600310,600396,600452,600483,600505,600509,600578,600642,600644,600674,600726,600744,600780,600795,600821,600863,600886,600900,600905,600969,600979,600995,601016,601619,601778,601908,601985,601991,603693:
            return "电力"
        case 59,96,159,554,637,698,819,968,2207,2221,2554,2629,2828,300157,300164,300191,300483,300839,600028,600256,600339,600346,600387,600583,600688,600759,600777,600871,600938,600968,601808,601857,603003,603353,603619,603727,603798:
            return "石油"
        case 655,708,709,717,761,778,825,898,923,932,959,1203,2075,2110,2132,2135,2318,2443,2445,2478,2541,2593,2743,2843,300881,600010,600019,600022,600117,600126,600231,600282,600295,600307,600382,600399,600477,600496,600507,600558,600569,600581,600782,600808,600992,601003,601005,601121,601686,601969,603028,603278,603878,603995,605158,688186,835857:
            return     "钢铁"
        case 60,426,506,603,612,629,630,633,657,688,737,751,758,762,807,831,878,933,960,962,969,975,1337,2114,2128,2149,2155,2160,2167,2171,2176,2182,2192,2203,2237,2240,2295,2340,2378,2379,2428,2460,2466,2497,2501,2532,2540,2578,2716,2738,2756,2806,2824,2842,2978,2988,2996,3038,300057,300139,300328,300337,300618,300697,300855,300930,300963,301026,301152,301219,600111,600219,600255,600259,600281,600301,600338,600361,600362,600392,600456,600459,600489,600490,600497,600531,600547,600549,600595,600615,600673,600711,600768,600888,600961,600988,601020,601069,601137,601168,601212,601388,601600,601609,601677,601702,601899,601958,603115,603132,603399,603527,603663,603799,603876,603937,603978,603993,605208,605376,688102,688122,688456,688786,831152,833751,833914,839167,871634,873576:
            return    "有色"
        case 301,420,677,703,782,936,949,2064,2206,2254,2427,2493,2998,300180,300699,300777,300876,301057,600063,600409,600527,600810,600889,601233,603225,603332,605166,688295,688722,836077:
            return "化纤"
        case 408,422,510,525,545,553,565,635,683,691,707,731,792,818,822,830,859,893,902,912,973,985,990,1207,1217,1218,1231,1255,1333,2002,2004,2014,2037,2054,2068,2092,2096,2108,2109,2125,2136,2145,2165,2170,2211,2215,2224,2226,2243,2246,2250,2258,2263,2274,2312,2319,2324,2326,2341,2360,2361,2381,2386,2391,2395,2407,2408,2440,2442,2453,2455,2457,2469,2470,2476,2496,2513,2522,2538,2539,2545,2556,2584,2585,2588,2601,2632,2641,2643,2648,2666,2669,2683,2694,2709,2734,2735,2741,2748,2749,2753,2768,2783,2802,2809,2810,2825,2827,2838,2886,2895,2909,2915,2917,2942,2971,2986,3002,3017,3018,3022,3042,300019,300037,300041,300054,300067,300082,300107,300109,300121,300132,300135,300169,300174,300198,300200,300214,300218,300221,300225,300230,300243,300261,300305,300320,300321,300343,300387,300393,300398,300405,300429,300437,300446,300478,300481,300487,300505,300522,300535,300537,300538,300539,300568,300575,300576,300586,300587,300596,300599,300610,300637,300641,300644,300665,300716,300717,300721,300727,300731,300758,300767,300769,300796,300798,300801,300804,300806,300821,300834,300847,300848,300849,300886,300891,300905,300910,300920,300927,300980,300995,301003,301019,301035,301036,301037,301059,301065,301069,301076,301077,301090,301092,301100,301118,301131,301149,301190,301198,301209,301212,301216,301220,301237,301238,301256,301286,301292,301300,301323,301349,301373,301393,301395,301518,301487,600075,600078,600096,600135,600141,600143,600160,600165,600227,600230,600273,600277,600309,600319,600328,600331,600352,600367,600370,600378,600389,600423,600426,600458,600470,600486,600500,600506,600596,600599,600610,600618,600623,600691,600714,600722,600727,600731,600746,600800,600844,600935,600955,600989,601065,601118,601208,601216,601568,601678,603002,603010,603026,603033,603041,603051,603065,603067,603077,603086,603110,603125,603150,603155,603172,603181,603188,603192,603212,603213,603217,603227,603255,603260,603281,603330,603360,603378,603379,603505,603580,603585,603599,603639,603650,603659,603681,603683,603722,603725,603737,603790,603806,603810,603822,603823,603826,603856,603867,603879,603916,603928,603931,603938,603948,603968,603970,603977,603980,603991,605008,605020,605033,605183,605366,605399,605488,605566,605589,688065,688093,688106,688116,688129,688133,688157,688199,688203,688219,688267,688268,688269,688323,688350,688353,688357,688359,688386,688550,688571,688585,688602,688603,688625,688669,688680,688690,688737,688548,430489,830832,830974,831304,831526,831834,832089,832175,832225,832471,833819,834033,834261,835185,836247,836871,836957,838163,838402,838971,839719,870204,870866,871694,873527    :
            return "化工"
        case 12,23,401,619,672,722,786,789,877,935,1212,1296,2043,2066,2080,2162,2201,2205,2225,2233,2247,2271,2302,2333,2372,2377,2392,2398,2596,2623,2652,2671,2718,2742,2785,2791,2918,3012,3037,300163,300196,300234,300285,300374,300395,300715,300737,300986,301010,301188,301429,600176,600293,600321,600326,600425,600449,600585,600586,600668,600678,600720,600801,600802,600819,600876,600881,601636,601865,601992,603256,603578,603601,603616,603969,605006,605122,605318,688119,833580,836149,839792:
            return     "建材"
        case 488,815,1206,2012,2067,2078,2235,2303,2511,2521,2565,3006,300883,301009,301469,600103,600235,600308,600356,600433,600567,600793,600963,600966,603165,603607,603733,603863,605007,605009,605377,605500,833394:
            return "造纸"
        case 795,970,1269,2056,2057,2088,300127,300179,300224,300554,300700,300748,300811,300835,300861,301071,301141,600172,600366,600516,603612,603688,605086,688077,688190,688300,688398,688598,688733,835179,836675,839725:
            return     "矿物制品"
        case 523,1328,2094,2637,2919,300740,300856,300955,300957,301108,301283,301371,600249,600315,603059,603605,603630,603983:
            return "日用化工"
        case 19,61,592,638,663,702,713,735,798,876,930,998,1201,1313,1366,2041,2069,2100,2124,2141,2157,2234,2299,2311,2321,2385,2458,2548,2567,2679,2688,2696,2714,2746,2772,2868,2891,2982,300087,300094,300119,300189,300268,300313,300498,300511,300673,300761,300871,300967,300970,300972,301156,301498,600097,600108,600127,600195,600201,600251,600257,600265,600299,600313,600354,600359,600371,600467,600540,600598,600811,600866,600883,600965,600975,601952,603151,603336,603363,603477,603566,603609,603668,603717,603718,603739,605296,688098,688526,831087,832419,838275,839729:
            return    "农林牧渔"
        case 17,26,726,850,955,982,1209,1234,2003,2029,2042,2083,2087,2098,2144,2154,2193,2269,2293,2327,2345,2394,2397,2404,2486,2494,2503,2563,2569,2574,2612,2634,2656,2674,2687,2721,2731,2740,2762,2763,2776,2780,2832,2867,2875,3016,3041,300005,300577,300591,300658,300819,300840,300877,300901,300918,300945,300952,300979,301066,301088,301177,301276,600107,600137,600156,600177,600220,600232,600398,600400,600439,600448,600493,600612,600630,600735,600916,600987,601339,601566,601599,601718,603001,603055,603073,603116,603130,603196,603238,603365,603511,603518,603555,603557,603558,603587,603608,603665,603808,603839,603877,603889,603900,603908,603958,605003,605055,605080,605138,605180,605189,605599,838262,871753    :
            return "纺织服饰"
        case 505,576,639,716,833,848,895,911,972,1215,1219,1318,2053,2216,2286,2329,2330,2481,2495,2507,2515,2557,2570,2582,2597,2650,2661,2695,2702,2719,2726,2732,2820,2840,2847,2852,2910,2946,2956,2991,3000,3030,300106,300138,300146,300175,300741,300765,300783,300829,300858,300892,300898,300908,300915,300973,300997,300999,301116,301206,600073,600186,600189,600191,600298,600300,600305,600419,600429,600597,600737,600872,600873,600882,600887,600929,600962,603020,603027,603043,603057,603079,603156,603170,603182,603237,603288,603299,603317,603345,603517,603536,603696,603697,603711,603719,603755,603777,603866,603886,605016,605077,605089,605179,605198,605300,605337,605338,605339,605388,605499,605567,688089,831726,832023,833429,836422,836826,839273,839371:
            return    "食品饮料"
            
        case 568,596,729,752,799,858,860,869,929,995,1338,2304,2461,2568,2646,600059,600084,600132,600197,600199,600238,600519,600543,600559,600573,600600,600616,600696,600702,600779,600809,601579,603198,603369,603589,603779,603919:
            return     "酿酒"
            
        case 16,333,404,521,541,651,801,810,921,1259,2005,2011,2032,2035,2050,2076,2242,2290,2403,2418,2420,2429,2508,2543,2614,2668,2676,2677,2705,2723,2759,2848,2860,2959,3023,300160,300217,300272,300342,300403,300625,300808,300824,300894,300911,301008,301187,301332,600060,600261,600336,600619,600690,600839,600854,600983,601956,603195,603215,603219,603303,603311,603355,603366,603486,603515,603519,603579,603657,603677,603726,603868,605336,605365,605555,688169,688609,688696,688793,430718,831768,836699,870199,870726:
            return     "家用电器"
            
        case 25,30,338,550,559,572,581,589,599,625,678,700,753,757,800,868,887,901,903,913,951,957,980,981,996,1260,1278,1282,1311,1319,1380,1696,2031,2048,2085,2101,2105,2126,2190,2239,2283,2284,2328,2355,2363,2406,2434,2448,2454,2472,2488,2510,2516,2536,2537,2553,2590,2592,2594,2662,2664,2703,2708,2715,2725,2758,2766,2813,2863,2870,2906,2920,2921,2965,2976,2984,3033,300100,300176,300237,300258,300304,300375,300428,300432,300473,300507,300547,300580,300585,300611,300643,300652,300680,300681,300694,300695,300733,300742,300745,300825,300863,300893,300926,300928,300969,300978,300985,301000,301005,301007,301039,301072,301119,301133,301170,301181,301192,301215,301225,301229,301233,301298,301310,301322,301345,301397,301398,301488,301499,600006,600066,600081,600099,600104,600148,600151,600166,600178,600182,600213,600218,600297,600303,600335,600375,600386,600418,600469,600480,600501,600523,600609,600626,600653,600660,600676,600686,600698,600699,600733,600741,600742,600822,600841,600933,600960,601058,601127,601163,601238,601279,601500,601633,601689,601777,601799,601965,601966,603006,603009,603013,603023,603035,603037,603040,603048,603085,603089,603119,603121,603129,603158,603161,603166,603178,603179,603190,603197,603201,603211,603239,603266,603286,603305,603306,603319,603335,603348,603358,603377,603390,603529,603586,603596,603633,603655,603701,603730,603758,603766,603767,603768,603786,603787,603788,603809,603917,603922,603926,603949,603950,603960,603982,603997,605005,605018,605068,605088,605128,605133,605151,605228,605255,605319,605333,688280,688326,688339,688533,688612,688667,689009,430418,830896,831195,831278,831906,832000,833454,833533,836221,836270,837242,837663,838030,838171,838837,839946,870436,834058    :
            return "汽车类"
            
        case 504,516,615,710,2022,2030,2044,2086,2172,2173,2219,2223,2382,2432,2524,2551,2626,2901,2932,2950,300003,300015,300030,300049,300143,300171,300206,300238,300244,300246,300247,300289,300298,300314,300318,300326,300347,300358,300396,300404,300406,300412,300439,300453,300463,300482,300529,300562,300595,300633,300639,300642,300653,300676,300677,300685,300753,300760,300791,300813,300832,300869,300888,300896,300942,300962,300981,301033,301060,301087,301093,301096,301097,301103,301122,301234,301235,301239,301257,301267,301290,301293,301333,301363,301367,301515,600055,600327,600381,600529,600530,600568,600587,600763,600807,603102,603127,603222,603301,603309,603387,603456,603658,603880,603882,603976,603987,605369,688013,688016,688026,688029,688050,688067,688068,688075,688085,688108,688114,688139,688161,688193,688198,688202,688212,688217,688236,688238,688253,688265,688271,688273,688277,688289,688298,688301,688310,688314,688315,688317,688338,688351,688358,688363,688366,688389,688393,688399,688410,688468,688575,688576,688580,688581,688606,688607,688613,688617,688621,688626,688656,688677,688767,430300,832278,832982,835892,872925:
            return     "医疗保健"
            
        case 910,1211,1216,1238,1322,1323,2084,2489,2571,2572,2615,2631,2790,2798,2853,3011,300616,300640,300729,300749,300993,301004,301055,301061,301113,301193,301227,301336,301356,301376,600337,601996,603008,603021,603038,603180,603208,603216,603221,603226,603268,603272,603313,603326,603385,603389,603408,603551,603600,603610,603615,603661,603709,603801,603816,603818,603833,603838,603848,603898,603992,605155,605268,831445,834765:
            return "家居用品"
            
        case 153,403,423,513,518,534,538,566,590,597,623,650,661,739,756,766,788,790,813,908,915,919,931,952,953,963,989,999,1367,2001,2007,2019,2020,2038,2082,2099,2102,2107,2118,2166,2198,2252,2262,2275,2287,2294,2317,2332,2349,2365,2370,2393,2399,2412,2422,2424,2433,2435,2437,2550,2562,2566,2581,2603,2644,2653,2675,2693,2728,2737,2750,2755,2773,2793,2817,2821,2826,2864,2873,2880,2898,2900,2907,2923,2940,3020,300006,300009,300016,300026,300039,300086,300108,300110,300111,300122,300142,300147,300149,300158,300181,300194,300199,300204,300233,300239,300254,300255,300267,300294,300357,300363,300381,300391,300401,300434,300436,300452,300485,300497,300519,300534,300558,300573,300583,300584,300601,300630,300636,300683,300702,300705,300723,300725,300759,300841,300878,300966,301047,301075,301080,301089,301111,301130,301201,301207,301211,301230,301246,301258,301277,301281,301301,301331,301509,600062,600079,600080,600085,600129,600161,600196,600200,600211,600216,600222,600252,600267,600276,600285,600329,600332,600351,600380,600420,600422,600436,600479,600488,600513,600518,600521,600535,600557,600566,600572,600594,600613,600624,600645,600664,600671,600682,600721,600739,600750,600771,600774,600789,600812,600851,600867,600976,600993,601089,603087,603139,603168,603229,603235,603259,603351,603367,603392,603439,603520,603538,603567,603590,603669,603676,603707,603811,603858,603896,603963,603998,605116,605177,605199,605507,688046,688062,688073,688076,688091,688105,688117,688131,688136,688137,688163,688166,688176,688177,688179,688180,688185,688189,688192,688197,688221,688222,688235,688247,688266,688276,688278,688293,688302,688319,688321,688331,688336,688356,688373,688382,688426,688428,688443,688488,688505,688506,688513,688520,688553,688566,688578,688639,688658,688670,688687,688739,688799,430017,430047,430478,830946,832566,832735,833230,833266,833575,836433,837344,871970,873167    :
            return "医药"
            
        case 7,28,58,78,411,417,419,501,564,622,652,668,679,705,715,759,785,829,861,882,950,1316,2024,2177,2187,2251,2277,2336,2344,2356,2390,2416,2419,2462,2561,2589,2697,2727,2788,2818,2872,2999,300622,300755,300937,301015,301017,301078,301126,301166,301263,301370,301408,600056,600272,600280,600306,600415,600511,600538,600628,600655,600693,600694,600697,600712,600713,600729,600738,600778,600785,600790,600814,600824,600827,600828,600829,600833,600838,600857,600858,600859,600865,600998,601010,601086,601116,601366,601607,601828,601933,603071,603101,603108,603122,603214,603233,603368,603708,603716,603883,603939,605136,605188,605266:
            return     "商业连锁"
            
        case 151,626,701,2072,2091,2485,2505,600058,600128,600250,600278,600287,600608,600710,600725,600753,600981,601028,601061:
            return    "商贸代理"
            
        case 156,529,665,719,793,802,892,917,1330,2181,2238,2292,2343,2699,2739,2905,300027,300133,300182,300251,300291,300364,300413,300426,300528,300654,300770,300788,301025,301052,301231,301262,600037,600088,600136,600229,600373,600551,600576,600637,600640,600715,600757,600825,600831,600936,600959,600977,600996,601019,601098,601595,601801,601811,601858,601900,601921,601928,601929,601949,601999,603096,603103,603230,603721,603999,605577,834021:
            return    "传媒娱乐"
            
        case 607,659,695,812,2027,2117,2191,2228,2229,2291,2374,2400,2599,2701,2712,2752,2787,2799,2831,2836,2846,2878,2951,2969,3003,300058,300071,300280,300501,300612,300781,300805,301062,301102,301223,301296,301355,600076,600210,600462,600836,600880,601515,601968,603022,603058,603429,603499,603687,603729,833075,872392,837174:
            return "广告包装"
            
        case 526,558,1222,1300,1368,2103,2301,2348,2575,2607,2621,2659,2678,2858,2862,2899,3032,300081,300192,300282,300329,300338,300359,300651,300662,300688,300703,300795,300860,300994,301101,301169,301287,301313,301335,600158,600455,600636,600661,600662,600679,600730,600818,600826,600861,603307,603466,603899,605098,605099,605299:
            return "文教休闲"
            
        case 428,721,2186,301073,600258,600754,601007,605108:
            return    "酒店餐饮"
            
        case 430,524,610,796,888,978,2033,2059,2159,2707,300144,300756,300859,600054,600138,600358,600593,600706,600749,601888,603099,603136,603199:
            return    "旅游"
            
        case 697,738,768,2023,2111,2297,2389,2625,2829,2933,2935,2985,3009,300034,300159,300424,300581,300696,300719,300722,300775,300900,300965,301050,600038,600118,600316,600343,600372,600391,600760,600765,600862,600879,600893,603261,605123,688070,688231,688237,688239,688281,688287,688297,688510,688523,688563,688586,688685,837006,871642:
            return    "航空"
        case 300008,300065,300589,300600,300810,600072,600150,600482,600685,600764,601890,601989:
            return "船舶"
            
        case 8,39,925,976,1324,2367,2689,2774,2972,300011,300351,300594,300669,300851,300923,300931,300960,301016,301048,301056,600243,600495,600528,600835,600894,600967,601766,603111,603321,603356,603488,603500,603611,603680,605001,605286,605298,688009,688015,688187,688285,688367,688459,688569,872541:
            return "运输设备"
            
        case 410,530,595,777,837,1268,2026,2046,2122,2150,2164,2248,2272,2282,2342,2347,2438,2480,2514,2520,2559,2598,2633,2685,2747,2760,2795,2823,2871,2877,2884,2896,2903,2931,2943,3025,300083,300091,300145,300154,300161,300257,300260,300345,300420,300421,300441,300464,300470,300488,300503,300606,300718,300780,300809,300817,300828,300838,300850,300885,300943,300946,300971,300984,300988,300992,301020,301040,301043,301070,301079,301107,301125,301137,301151,301160,301163,301202,301232,301252,301255,301261,301268,301273,301279,301309,301311,301317,301368,301377,301399,301446,301448,600114,600592,601002,601177,601369,601882,603011,603088,603112,603173,603187,603269,603308,603315,603617,603667,603699,603757,603915,603985,605060,605100,605389,688017,688028,688059,688255,688257,688305,688308,688333,688355,688360,688379,688455,688558,688577,688697,430510,831855,832662,833943,836720,836807,836942,838670,870508,871245,873169,873223,873305,873593:
            return    "通用机械"
            
        case 519,551,570,584,816,852,856,880,988,1223,1225,1256,1288,1332,1336,2006,2008,2021,2073,2196,2204,2209,2255,2265,2278,2337,2353,2366,2430,2444,2490,2529,2530,2534,2595,2611,2613,2630,2639,2645,2651,2686,2690,2691,2698,2722,2730,2757,2779,2786,2816,2833,2837,2890,2957,2960,2975,2979,2997,3036,300022,300024,300084,300092,300097,300126,300151,300173,300193,300195,300210,300220,300227,300228,300263,300276,300278,300281,300293,300307,300316,300382,300400,300402,300411,300415,300450,300457,300461,300471,300472,300480,300486,300499,300509,300512,300521,300527,300540,300545,300549,300607,300619,300707,300724,300747,300751,300757,300776,300802,300812,300818,300823,300833,300836,300837,300853,300865,300875,300879,300902,300922,300950,300990,300998,301011,301013,301018,301021,301022,301028,301029,301053,301083,301105,301112,301128,301138,301158,301186,301196,301199,301200,301260,301272,301312,301325,301328,301338,301353,301357,301360,301468,301512,301533,600184,600202,600215,600262,600302,600330,600355,600421,600435,600444,600499,600545,600579,600817,600843,600855,600860,600980,601038,601606,601608,601717,601798,603012,603025,603029,603032,603036,603076,603081,603090,603095,603131,603135,603159,603169,603203,603277,603280,603282,603283,603289,603298,603331,603337,603338,603339,603396,603638,603656,603666,603698,603789,603800,603855,603895,603901,603912,603956,605186,605259,605305,688001,688003,688022,688025,688071,688084,688090,688092,688097,688113,688121,688125,688128,688147,688151,688155,688162,688165,688170,688188,688211,688215,688218,688251,688290,688306,688312,688328,688329,688376,688377,688378,688383,688392,688400,688420,688425,688433,688448,688499,688516,688518,688529,688531,688543,688551,688556,688557,688559,688570,688596,688623,688627,688630,688633,688638,688646,688700,688777,688789,688573,430425,831689,831856,833455,833781,834014,834475,834599,835174,835368,836717,838810,871478,871553,872895:
            return    "工业机械"
            
            
            
        case 9,49,400,533,573,682,720,821,922,1208,1283,1301,2028,2052,2074,2112,2129,2130,2169,2202,2218,2227,2245,2249,2270,2276,2300,2309,2334,2335,2339,2346,2350,2358,2364,2441,2451,2452,2459,2471,2487,2498,2506,2518,2531,2533,2546,2560,2576,2580,2606,2610,2617,2622,2660,2665,2692,2706,2733,2782,2801,2805,2812,2850,2851,2865,2879,2882,2892,2922,2927,2953,3008,300001,300004,300014,300018,300029,300035,300040,300048,300062,300068,300069,300073,300080,300093,300095,300116,300117,300118,300125,300129,300141,300153,300207,300208,300215,300222,300265,300274,300283,300317,300340,300341,300376,300390,300407,300409,300410,300423,300427,300438,300443,300444,300447,300477,300484,300490,300491,300510,300530,300569,300593,300617,300626,300648,300660,300670,300690,300693,300713,300750,300763,300772,300820,300827,300842,300870,300889,300890,300907,300919,300932,300933,300953,301002,301012,301023,301031,301063,301082,301120,301121,301150,301155,301157,301168,301210,301222,301226,301266,301278,301291,301295,301320,301327,301358,301359,301361,301386,301388,301439,301456,300904,301362,301418,301511,600089,600110,600112,600152,600192,600207,600212,600241,600268,600290,600312,600379,600405,600406,600416,600438,600468,600478,600481,600525,600537,600550,600560,600577,600580,600590,600732,600847,600869,600875,600884,600885,600973,601012,601126,601179,601218,601311,601615,601616,601700,601727,601877,603015,603016,603031,603045,603050,603063,603070,603097,603105,603109,603185,603191,603218,603320,603333,603398,603489,603507,603530,603577,603583,603606,603618,603628,603679,603685,603728,603819,603829,603861,603897,603906,603988,605066,605117,605196,605222,605288,605378,688005,688006,688032,688033,688063,688103,688148,688184,688223,688226,688248,688275,688303,688330,688334,688345,688348,688349,688388,688390,688395,688408,688429,688472,688503,688517,688560,688567,688599,688611,688660,688663,688676,688681,688698,688707,688772,688778,688779,688819,830809,831641,832110,833523,834062,834639,834682,834770,835237,835985,836239,837046,870299,873152:
            return "电气设备"
            
        case 157,425,528,680,811,1226,1360,2009,2097,2158,2483,2523,2526,2535,2667,300185,300201,300275,301032,301161,600031,600169,600320,600582,600761,600815,600984,601100,601106,601399,603966,830839:
            return    "工程机械"
            
        case 1266,2058,2121,2175,2214,2338,2414,2527,2767,2819,2849,2857,2967,2980,300007,300012,300066,300099,300105,300112,300114,300124,300165,300259,300286,300306,300349,300354,300360,300370,300371,300416,300417,300430,300445,300466,300514,300515,300516,300553,300557,300567,300572,300667,300720,300797,300862,300880,300882,300887,300897,300906,300938,301006,301129,301228,301289,301303,301510,600651,601222,601567,603100,603416,603556,603662,603700,605056,688056,688112,688115,688160,688283,688320,688337,688528,688539,688582,688597,688600,688610,688616,688622,688628,688665,688686,688768,430476,430556,430685,830779,830879,831305,831961,832651,832885,833509,834407,836260,836414,871396:
            return    "电器仪表"
            
        case 300959,600050,600804,600941,601698,601728:
            return    "电信运营"
            
        case 2627,600561,600611,600650,600834,603776:
            return    "公共交通"
            
        case 598,685,3039,300262,300334,300631,301519,600168,600187,600283,600461,601158,601199,601368,603291,603759,688718:
            return    "水务"
            
        case 407,421,593,605,669,692,1210,1299,2259,2267,2700,2893,2911,300332,300335,300435,600052,600167,600226,600333,600617,600635,600681,600719,600803,600903,600917,600956,600982,601139,603053,603080,603318,603393,603689,603706,605011,605028,605090,605162,605169,605368,605580,831010:
            return     "供气供热"
            
        case 5,35,68,544,546,711,803,820,826,885,890,920,967,1230,2034,2210,2266,2479,2549,2573,2591,2616,2658,2672,2717,2778,2887,2973,3027,300055,300056,300070,300072,300103,300137,300140,300152,300172,300187,300190,300197,300203,300266,300355,300385,300388,300422,300425,300495,300614,300664,300692,300774,300779,300786,300800,300815,300816,300854,300864,300867,300899,300912,300929,300948,300958,300961,301030,301049,301068,301081,301109,301127,301148,301175,301203,301259,301265,301288,301305,301372,600008,600217,600292,600323,600388,600475,600526,600796,600874,601200,601330,601827,603126,603177,603200,603279,603324,603359,603568,603588,603603,603686,603797,603817,603903,603955,605069,605081,688021,688057,688069,688087,688096,688101,688156,688178,688196,688309,688335,688370,688466,688480,688485,688501,688565,688659,688679,688701,688671,831370,832145,832802,836263:
            return "环境保护"
            
        case 99,520,557,1205,2320,2357,2928,600026,600029,600115,600125,600221,600428,600575,600751,600798,601006,601021,601022,601111,601156,601333,601816,601866,601872,601919,601975,603069,603162,603167,603209,603885,833171,872351:
            return    "运输服务"
            
        case 906,927,1202,1213,1228,1317,1331,2010,2120,2183,2352,2468,2492,2682,2769,2800,2889,2930,300013,300240,300873,600057,600119,600153,600179,600180,600233,600704,600755,600787,600794,601598,603056,603066,603117,603128,603223,603329,603535,603565,603569,603648,603713,603813,603836,603871,603967,605050:
            return    "仓储物流"
            
        case 88,89,429,507,548,582,755,828,900,905,1872,1965,2040,600004,600009,600012,600017,600018,600020,600033,600035,600106,600190,600269,600279,600350,600368,600377,600515,600548,600717,600897,601000,601008,601018,601107,601188,601228,601298,601326,601518,601880:
            return "交通设施"
            
        case 1,1227,2142,2807,2839,2936,2948,2958,2966,600000,600015,600016,600036,600908,600919,600926,600928,601009,601077,601128,601166,601169,601187,601229,601288,601328,601398,601528,601577,601658,601665,601818,601825,601838,601860,601916,601939,601963,601988,601997,601998,603323:
            return    "银行"
            
            
        case 166,686,712,728,750,776,783,2500,2670,2673,2736,2797,2926,2939,2945,300059,600030,600061,600095,600109,600155,600369,600621,600837,600864,600906,600909,600918,600958,600999,601059,601066,601099,601108,601136,601162,601198,601211,601236,601375,601377,601456,601555,601688,601696,601788,601878,601881,601901,601990,601995:
            return    "证券"
            
            
            
        case 627,601318,601319,601336,601601,601628:
            return "保险"
            
        case 46,415,416,532,563,567,617,666,958,987,1236,2423,2647,2961,600053,600120,600318,600390,600517,600643,600705,600783,600816,600830,600901,600927,603093,603123,603300:
            return    "多元金融"
            
        case 10,32,55,65,90,498,628,779,928,1267,2047,2051,2060,2061,2062,2081,2116,2140,2163,2200,2307,2310,2323,2325,2375,2431,2482,2504,2542,2564,2586,2620,2628,2663,2713,2761,2775,2789,2811,2822,2830,2856,2883,2941,2949,2963,2989,3001,3013,300021,300284,300384,300492,300500,300506,300517,300536,300564,300621,300635,300649,300668,300675,300712,300732,300746,300778,300826,300844,300949,300977,300982,300983,300989,301024,301027,301038,301058,301091,301098,301115,301136,301167,301365,301390,301505,600039,600133,600170,600193,600234,600248,600284,600491,600502,600512,600606,600629,600769,600820,600846,600853,600939,600970,601068,601117,601133,601186,601226,601390,601611,601618,601668,601669,601789,601800,601868,601886,603007,603017,603018,603030,603060,603098,603137,603153,603163,603176,603183,603316,603357,603388,603458,603637,603778,603815,603828,603843,603860,603909,603929,603959,603979,605167,605178,605287,605289,605303,605598,830964,831039,833427,833873,836208,836892:
            return "建筑"
            
        case 2,6,11,14,29,31,36,42,48,56,69,402,514,517,560,608,609,616,620,656,671,718,732,736,797,809,838,863,886,897,926,961,965,1914,1979,2016,2133,2146,2188,2208,2244,2285,2305,2314,2968,300917,300947,600007,600048,600064,600067,600082,600094,600113,600159,600162,600173,600185,600208,600223,600239,600246,600266,600322,600325,600340,600376,600383,600463,600503,600510,600533,600565,600603,600604,600605,600622,600638,600639,600641,600648,600649,600657,600658,600663,600665,600675,600683,600684,600692,600708,600716,600724,600736,600743,600748,600773,600791,600823,600848,600895,601155,601512,601588,603506,603682:
            return    "房地产"
            
        case 66,977,997,1229,1339,2152,2180,2197,2236,2308,2351,2376,2415,2528,2577,2835,2866,2912,2955,2970,300042,300045,300076,300130,300155,300249,300270,300333,300368,300449,300455,300462,300546,300552,300656,300743,300771,300793,300857,300884,300941,301042,301189,301318,301330,301391,301503,600100,603019,603106,603496,603516,603660,688208,688288,688475,688489,430198,832876,836395,872190,872374,872808:
            return     "IT设备"
            
        case 63,70,547,561,586,836,851,889,2017,2089,2093,2104,2151,2161,2194,2231,2281,2296,2313,2369,2383,2396,2413,2446,2465,2491,2519,2544,2547,2583,2792,2796,2869,2881,2902,2929,2977,3040,300025,300050,300079,300101,300134,300177,300183,300205,300211,300213,300252,300308,300310,300353,300394,300397,300414,300502,300504,300531,300548,300555,300560,300563,300565,300570,300578,300590,300597,300603,300615,300620,300627,300628,300638,300689,300698,300710,300711,300736,300762,300913,301139,301165,301191,301205,301307,600105,600131,600198,600345,600487,600498,600522,600562,600775,600776,600990,601138,601869,603042,603083,603118,603206,603220,603236,603322,603421,603559,603602,603703,603712,603803,688002,688027,688036,688080,688100,688132,688143,688159,688175,688182,688205,688282,688313,688387,688418,688507,688522,688552,688618,688668,688788,688592,835640,838924:
            return    "通信设备"
        case 1270,1309,2049,2077,2079,2119,2156,2185,2213,2371,2409,2449,2638,3026,3043,300046,300053,300077,300102,300123,300223,300236,300241,300301,300303,300323,300327,300346,300373,300456,300458,300604,300613,300623,300632,300655,300661,300666,300671,300672,300708,300782,300831,301095,301269,301297,301308,301369,301348,600171,600206,600360,600460,600520,600584,600667,600703,600745,600877,603005,603061,603068,603078,603160,603290,603501,603690,603893,603986,605111,605358,688008,688012,688018,688019,688035,688037,688041,688045,688047,688048,688049,688052,688061,688072,688082,688099,688107,688110,688120,688123,688126,688130,688135,688138,688141,688146,688153,688172,688173,688200,688206,688209,688213,688216,688220,688230,688233,688234,688249,688252,688256,688259,688261,688262,688270,688279,688286,688325,688332,688352,688361,688362,688368,688372,688380,688381,688385,688391,688396,688401,688403,688409,688416,688419,688432,688458,688469,688478,688484,688486,688498,688508,688512,688515,688521,688525,688535,688536,688538,688589,688593,688595,688601,688608,688620,688689,688699,688711,688728,688766,688798,688981,688347,688693,430139:
            return    "半导体"
        case 20,21,45,50,62,100,413,509,536,636,670,725,727,733,823,1287,1298,1308,1314,1373,2025,2036,2045,2055,2106,2134,2137,2138,2139,2179,2189,2199,2217,2222,2241,2273,2288,2289,2384,2387,2388,2402,2426,2436,2456,2463,2475,2484,2512,2552,2579,2587,2600,2635,2636,2655,2681,2724,2729,2745,2765,2808,2815,2841,2845,2855,2859,2861,2876,2885,2888,2897,2908,2913,2916,2925,2937,2938,2947,2952,2962,2981,2983,2992,2993,3015,3019,3021,3028,3031,300032,300088,300115,300120,300128,300131,300136,300162,300184,300219,300232,300256,300269,300279,300296,300319,300322,300331,300389,300408,300433,300460,300474,300475,300476,300489,300493,300543,300566,300582,300602,300629,300647,300650,300657,300679,300684,300686,300691,300701,300706,300709,300726,300735,300739,300752,300787,300790,300814,300822,300843,300852,300866,300868,300903,300909,300916,300936,300939,300940,300951,300956,300964,300968,300975,300976,300991,301041,301045,301051,301067,301086,301099,301106,301123,301132,301135,301176,301180,301182,301183,301217,301280,301282,301285,301314,301319,301321,301326,301329,301366,301379,301383,301387,301389,301419,301486,301421,600071,600130,600183,600203,600237,600288,600353,600363,600552,600563,600601,600666,600707,600898,601231,603052,603133,603186,603228,603267,603297,603327,603328,603380,603386,603595,603626,603629,603678,603738,603773,603890,603920,603933,603936,603989,605058,605118,605218,605258,605277,605588,688007,688010,688011,688020,688053,688055,688079,688127,688150,688167,688181,688183,688195,688210,688260,688272,688299,688307,688311,688322,688371,688375,688439,688496,688502,688511,688519,688629,688636,688655,688661,688662,688678,688683,688776,688800,603296,831167,832149,832491,833346,834950,837212,837821,838701,870357,871857,871981,873001,873339:
            return    "元器件"
            
        case 4,34,158,409,503,555,938,948,2063,2065,2090,2153,2178,2184,2195,2212,2230,2232,2253,2261,2268,2279,2280,2298,2316,2322,2331,2362,2368,2373,2380,2401,2405,2410,2421,2439,2474,2609,2642,2649,2657,2771,2777,2987,2990,3004,3005,3007,3029,300010,300017,300020,300033,300036,300044,300047,300074,300075,300078,300085,300096,300098,300150,300166,300167,300168,300170,300188,300212,300229,300231,300235,300245,300248,300250,300253,300264,300271,300277,300287,300288,300290,300300,300302,300311,300324,300339,300344,300348,300350,300352,300365,300366,300369,300377,300378,300379,300380,300383,300386,300419,300440,300442,300448,300451,300454,300465,300468,300469,300479,300496,300508,300513,300520,300523,300525,300532,300541,300542,300550,300551,300556,300559,300561,300579,300588,300598,300605,300608,300609,300624,300634,300645,300659,300663,300674,300678,300682,300687,300730,300738,300768,300773,300789,300799,300803,300807,300830,300845,300846,300872,300895,300925,300935,300996,301085,301117,301153,301159,301162,301172,301178,301179,301185,301195,301197,301208,301213,301218,301221,301236,301248,301270,301302,301315,301316,301337,301339,301378,301380,301396,600225,600271,600289,600410,600446,600476,600536,600570,600571,600588,600589,600602,600718,600728,600734,600756,600797,600845,600850,600868,601519,603039,603138,603171,603189,603232,603383,603508,603528,603636,603859,603869,603881,603887,603918,603927,603990,605398,688004,688023,688030,688031,688038,688039,688051,688058,688060,688066,688078,688081,688083,688088,688095,688109,688111,688118,688152,688158,688168,688171,688191,688201,688207,688225,688227,688228,688229,688232,688244,688246,688258,688291,688292,688296,688316,688318,688327,688343,688365,688369,688435,688450,688479,688509,688561,688562,688568,688579,688588,688590,688619,688631,688651,688682,688787,430090,430564,830799,831832,832171,834415,835184,835207,835305,835508,835670,837092,837592,838227,839680,839790,837748:
            return "软件服务"
        case 676,681,971,2095,2113,2115,2123,2127,2131,2148,2168,2174,2264,2306,2315,2354,2425,2467,2502,2517,2555,2558,2602,2605,2624,2640,2654,2803,2995,3010,300002,300031,300043,300051,300052,300061,300063,300113,300148,300209,300226,300242,300292,300295,300299,300315,300399,300418,300459,300467,300494,300518,300533,300571,300592,300766,300785,300792,300921,300987,301001,301110,301171,301299,301381,301382,301428,600070,600228,600365,600539,600556,600633,600892,600986,601113,601360,603000,603258,603444,603533,603598,603613,603825,603888,605168,688500:
            return    "互联网"
        case 631,632,839,881,909,301306,600051,600083,600149,600620,600647,600654,600689,600766,600770,600784,600805,873122:
            return    "综合类"
        default:
            return "错误"
        }
    }
}

//数据 //股票代码 name pe pb price percent

func getData() -> String{
    return """
600219   南山铝业  3000  2.92% 2,565.00 28.45%   11,580.00
600000   浦发银行  1100  2.92% 3,600.10 45.28%   11,550.00
600483   福能股份  1100  2.61% 1,381.00 15.43%   10,329.00
600064   南京高科  1400  2.52% 730   7.89% 9,982.00
601006   大秦铁路  1400  2.42% 777.54   8.82% 9,590.00
603368   柳药集团  500   2.21% 13.5  0.15% 8,750.00
2432  九安医疗  200   2.17% 1,511.00 21.33%   8,596.00
600018   上港集团  1400  2.03% 952.8 13.48%   8,022.00
600328   中盐化工  1000  1.86% -1,722.00   -18.96%  7,360.00
726   鲁泰A   1100  1.73% -342  -4.75%   6,853.00
600104   上汽集团  300   1.33% 937.16   21.61%   5,274.00
600089   特变电工  400   1.24% -29.5 -0.59%   4,932.00
600585   海螺水泥  200   1.18% -533  -10.23%  4,678.00
2091  江苏国泰  500   0.95% -183.01  -4.62%   3,775.00
581   威孚高科  200   0.91% 313   9.51% 3,606.00
623   吉林敖东  200   0.84% 167   5.29% 3,322.00
600050   中国联通  500   0.81% 1,688.20 110.93%  3,210.00
725   京东方A  700   0.80% 580.49   22.41%   3,171.00
685   中山公用  300   0.66% 848.7 48.10%   2,613.00
600704   物产中大  500   0.64% 294.9 13.05%   2,555.00
600028   中国石化  400   0.61% 1,034.40 75.53%   2,404.00
910   大亚圣象  300   0.56% -368.12  -14.19%  2,226.00
601398   工商银行  300   0.54% 1,057.98 98.97%   2,127.00
2932  明德生物  100   0.48% -835  -30.53%  1,900.00
601186   中国铁建  200   0.42% 181   12.07%   1,680.00
601339   百隆东方  300   0.40% 276.9 21.18%   1,584.00
601669   中国电建  300   0.39% -90.03   -5.56%   1,530.00
2034  旺能环境  100   0.37% -39.99   -2.68%   1,453.00
600308   华泰股份  420   0.37% -222.02  -13.29%  1,449.00
600051   宁波联合  200   0.34% 55 4.31% 1,332.00
898   鞍钢股份  500   0.30% -425.6   -26.26%  1,195.00
300158   振东制药  300   0.30% -844.8   -41.62%  1,185.00
600655   豫园股份  200   0.28% -412.1   -26.76%  1,128.00
600153   建发股份  100   0.25% 88 9.54% 1,010.00
401   冀东水泥  200   0.25% -745.02  -43.39%  972
932   华菱钢铁  200   0.23% -25.01   -2.72%   894
603898   好莱客   100   0.22% -68.1 -7.18%   880
2233  塔牌集团  100   0.19% -90.1 -10.80%  744
"""
}

//name pe pb percent 代码
func translateData(rawData:String) -> [stockModel] {
    // 将数据转换为数组
    let lines = rawData.split(separator: "\n")
    var stockDataList: [stockModel] = []
    
    for line in lines {
        let components = line.split(separator: " ").filter { !$0.isEmpty }
        if components.count == 7,
           let value0 = Int(String(components[0])),
           let value6 = Double(components[6].replacingOccurrences(of: ",", with: ""))//百分比
        {
            let stock = stockModel(
                name: String(components[1]),
                code: value0,
                price: value6
            )
            stockDataList.append(stock)
        }
    }
    return stockDataList
}

//print("名称,股价,PETTM,PB,百分位,代码,行业,PE分数,PB分数,百分位分数,总分,当前标尺")
//
let stockData = getData()
var stockArray:[stockModel] = []
stockArray = translateData(rawData: stockData)

var industryArray:[IndustryModel] = []
industryArray = creatIndustryArray(rawData:stockArray)
//for model in array{
//    let newScore = newPePbScore(industry: model.industry)
//    print("\(model.name),\(model.price),\(model.pe),\(model.pb),\(model.percent),\(model.code),\(model.industry),\(model.pe_score),\(model.pb_score),\(model.percent_score),\(model.total_score),\(newScore.peScore) \(newScore.pbScore)")
//}


// 使用Swift标准库优化
func creatIndustryArray(rawData: [stockModel]) -> [IndustryModel] {
    Dictionary(grouping: rawData) { $0.industry } // 自动分组
        .map { IndustryModel(name: $0.key, stocks: $0.value) }
        .sorted { $0.name < $1.name } // 按行业名称排序
}

func printIndustryReport(industryArray: [IndustryModel],totalStockValue:Double) {
    var grandTotal: Double = 0
    
    for industry in industryArray.sorted(by: { $0.name < $1.name }) {
        let industryHeader = """
        ┌───────────────────────────────────
        │ 行业：\(industry.name)
        │ 行业占比：\(String(format: "%.4f", industry.totalPrice/totalStockValue)) 需要投入：\(String(format: "%.2f", totalStockValue*0.03 - industry.totalPrice)) 元
        │ 行业总价：\(String(format: "%.2f", industry.totalPrice)) 元
        
        """
        print(industryHeader)
        
        for (index, stock) in industry.stocks.enumerated() {
            let stockInfo = String(format: "│   %2d. %-6d %-20@ ¥%.2f",
                                   index + 1,
                                   stock.code,
                                   stock.name,
                                   stock.price)
            print(stockInfo)
        }
        
        let industryFooter = """
        └───────────────────────────────────
        本行业共计 \(industry.stocks.count) 只股票
        """
        print(industryFooter)
        
        grandTotal += industry.totalPrice
        print() // 空行分隔
    }
    
    let summary = """
    ========================================
    全市场总计：
    - 行业数量：\(industryArray.count) 个
    - 股票总数：\(industryArray.reduce(0) { $0 + $1.stocks.count }) 只
    - 市场总市值：\(String(format: "%.2f", grandTotal)) 元
    ========================================
    """
    print(summary)
}

// 调用示例
printIndustryReport(industryArray: industryArray,totalStockValue:396147.41)


